---
interface Logo {
  src: string;
  alt?: string;
}

interface Props {
  title: string;
  kicker?: string;
  logos: Logo[];
  direction?: "ltr" | "rtl";
  speedSec?: number;
}

const {
  title,
  kicker,
  logos = [],
  direction = "ltr",
  speedSec = 2,
} = Astro.props as Props;

// Initial transform + animation-direction tweak for RTL
const startTransform =
  direction === "rtl" ? "translateX(-50%)" : "translateX(0)";
const animDirection = direction === "rtl" ? "normal" : "reverse";
---

<div
  class={`bg-n-50 overflow-hidden rounded-2xl border-b-8 border-orange-500 p-5 md:border-b-0 md:p-7 md:px-11 md:py-8 lg:px-9 lg:py-10 ${direction == "ltr" ? "md:border-l-[10px] lg:border-l-[12px]" : "md:border-r-[10px] lg:border-r-[12px]"}`}
>
  <div
    class={`flex flex-col gap-5 md:flex-row  md:items-center md:justify-between ${direction == "rtl" ? "md:flex-row-reverse" : ""}`}
  >
    <!-- Heading -->
    <div class={`${direction == "rtl" ? "text-right" : ""}`}>
      {
        kicker && (
          <p class="text-sm font-medium text-slate-600 lg:text-xl">{kicker}</p>
        )
      }
      <p class="l text-3xl font-bold text-orange-500 md:text-4xl lg:text-6xl">
        {title}
      </p>
    </div>

    <!-- Marquee (duplicate list for seamless loop) -->
    <div class="group w-full overflow-hidden">
      <div
        class="flex items-center gap-6 will-change-transform md:gap-14"
        style={`transform:${startTransform}; animation: pb-marquee ${speedSec}s linear infinite; animation-direction:${animDirection};`}
      >
        <!-- GROUP 1 -->
        <ul class="flex min-w-max items-center gap-6 md:gap-14">
          {
            logos.map((logo) => (
              <li>
                <img
                  class="h-20 w-full object-contain lg:h-[100px] lg:w-full"
                  src={logo.src}
                  alt={logo.alt ?? ""}
                  loading="lazy"
                  decoding="async"
                />
              </li>
            ))
          }
        </ul>

        <!-- GROUP 2 (duplicate, decorative) -->
        <ul
          class="flex min-w-max items-center gap-6 md:gap-14"
          aria-hidden="true"
        >
          {
            logos.map((logo) => (
              <li>
                <img
                  class="h-20 w-full object-contain lg:h-[100px] lg:w-full"
                  src={logo.src}
                  alt=""
                  loading="lazy"
                  decoding="async"
                />
              </li>
            ))
          }
        </ul>
      </div>
    </div>
  </div>

  <style>
    /* One shared keyframe: -50% -> 0 (LTR).
       For RTL we set initial transform to 0 and use animation-direction: reverse. */
    @keyframes pb-marquee {
      0% {
        transform: translateX(-50%);
      }
      100% {
        transform: translateX(0);
      }
    }
    /* Pause on hover (nice UX) */
    .group:hover > div {
      animation-play-state: paused;
    }
  </style>
</div>
