---
// LAYOUT //
import Layout from "@/layouts/Layout.astro";

// META //
import iconsAndAchieversMeta from "@/data/meta/student-leaders/icons-and-achievers/icons-and-achievers.json";

// COMPONENTS //
import SectionHeaderMain from "@/components/SectionHeaderMain.astro";
import Breadcrumbs from "@/components/Breadcrumbs.astro";
import FilterBar from "@/components/FilterBar.astro";
import EmptyState from "@/components/EmptyState.astro";
import IconsCard from "@/components/IconsCard.astro";

// DATA //
import {
  achievers,
  achieversBreadcrumbItems,
  achieversSectionHeader,
} from "@/data/student-leaders/achievers";

// Get the Year from the URL - or - the latest year in Data
const year: number =
  Number(Astro.url.searchParams.get("year")) || achievers?.years[0];

// Get the Students for the Year Selected
const students = achievers?.achievers[year];
---

<Layout meta={iconsAndAchieversMeta}>
  <section class="bg-n-50 relative w-full overflow-hidden">
    <div
      class="container m-auto flex flex-col gap-10 px-5 pt-32 pb-14 md:gap-14 lg:gap-16 lg:pt-40"
    >
      <!-- Breadcrumbs -->
      <Breadcrumbs items={achieversBreadcrumbItems} />

      <!-- Body of the Results -->
      <div class="flex flex-col gap-8 md:gap-12 lg:gap-14">
        <!-- Section Header -->
        <SectionHeaderMain
          title={achieversSectionHeader.title}
          subtitle={achieversSectionHeader.subtitle}
        />

        <!-- Filter & Students -->
        <div class="flex flex-col gap-7 md:gap-8 lg:gap-11">
          <!-- Years Filters -->
          <FilterBar showSearch={false} years={achievers.years} />

          <!-- List of Icons & Achievers -->
          {
            students && students.length > 0 ? (
              <div class="grid grid-cols-1 gap-5 md:grid-cols-2 md:gap-6 lg:grid-cols-3">
                {students?.map((studentsItem, studentsItemIndex) => (
                  <div
                    class="card-anim"
                    style={`--delay: ${studentsItemIndex * 0.2}s`}
                  >
                    <IconsCard {...studentsItem} />
                  </div>
                ))}
              </div>
            ) : (
              <EmptyState />
            )
          }
        </div>
      </div>
    </div>
  </section>
</Layout>
