---
export const prerender = true;

// TYPES //
import type { MemberData } from "@/types/member";

// COMPONENTS //
import Breadcrumbs from "@/components/ui/Breadcrumbs.astro";

// CONSTANTS //
import { URLS } from "@/infrastructure/constants/urls";

// OTHERS //
import Layout from "@/layouts/Layout.astro";

// SECTIONS //
import MemberConsumption from "@/sections/member-consumption/MemberConsumption.astro";

// DATA //
import { teamMembers } from "@/data/about/members/team";
import { advisoryBoard } from "@/data/about/members/advisory";
import { founderDetails } from "@/data/about/members/founder";

/**
 * Generate static paths for all team and advisory board member pages
 * @returns Array of static paths with member data
 */
export async function getStaticPaths() {
  const paths: Array<{
    params: { personType: string; id: string; name: string };
    props: {
      personType: string;
      member: MemberData;
    };
  }> = [];

  // Generate paths for team members
  teamMembers.forEach((member: MemberData) => {
    paths.push({
      params: {
        personType: "team",
        id: member.id.toString(),
        name: member.name.toLowerCase().replaceAll(" ", "-"),
      },
      props: {
        personType: "team",
        member,
      },
    });
  });

  // Generate path for Founder
  paths.push({
    params: {
      personType: "founder",
      id: "1",
      name: founderDetails.name.toLowerCase().replaceAll(" ", "-"),
    },
    props: {
      personType: "founder",
      member: founderDetails,
    },
  });

  // Generate paths for advisor board members
  advisoryBoard.forEach((member: MemberData) => {
    paths.push({
      params: {
        personType: "advisory",
        id: member.id.toString(),
        name: member.name.toLowerCase().replaceAll(" ", "-"),
      },
      props: {
        personType: "advisory",
        member,
      },
    });
  });

  return paths;
}

const { personType, member } = Astro.props;

console.log(member);

// Prepare breadcrumb items based on personType
const breadcrumbItems =
  personType === "team"
    ? [
        { label: "Key Personnel", href: `${URLS.ABOUT.ROOT}#key-personnel` },
        { label: member.name, href: `#` },
      ]
    : personType === "founder"
      ? [
          {
            label: "Founder â€“ Chairman",
            href: `${URLS.ABOUT.ROOT}#our-founder`,
          },
          { label: member.name, href: `#` },
        ]
      : [
          {
            label: "Advisory Board",
            href: `${URLS.ABOUT.ROOT}#advisory-board`,
          },
          { label: member.name, href: `#` },
        ];

// Prepare section header details
const sectionHeaderDetails = {
  title: member.name,
  subtitle: member.position,
};
---

<Layout>
  <!-- Breadcrumbs Section -->
  <div class="bg-n-50 relative w-full overflow-hidden">
    <div
      class="container mx-auto px-6 pt-30 pb-5 md:pt-40 md:pb-8 lg:pb-9 2xl:px-0"
    >
      <Breadcrumbs items={breadcrumbItems} />
    </div>
  </div>
  <MemberConsumption
    sectionHeaderDetails={sectionHeaderDetails}
    memberContent={member}
  />
</Layout>
